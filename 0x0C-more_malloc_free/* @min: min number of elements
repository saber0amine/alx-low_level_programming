* @max: max number of elements
